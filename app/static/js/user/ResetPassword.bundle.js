webpackJsonp([10],{0:function(e,a,n){"use strict";n(349),n(350),n(7);var t=n(17),m=n(174),i=(n(8),n(352)),r=n(355),o=t.createClass({displayName:"ResetPassword",render:function(){return t.createElement("div",{className:"wrap"},t.createElement(i,null),t.createElement(r,null))}});m.render(t.createElement(o,null),document.getElementById("box"))},7:function(e,a,n){e.exports=n.p+"img/user/favicon.png"},349:function(e,a,n){e.exports=n.p+"../templates/user/reset_password.html"},350:function(e,a,n){var t=n(351);"string"==typeof t&&(t=[[e.id,t,""]]);n(6)(t,{singleton:!1});t.locals&&(e.exports=t.locals)},351:function(e,a,n){a=e.exports=n(4)(),a.push([e.id,".clearfix:after{display:table;content:'';clear:both}a{color:#833e00}a:hover{color:#5a2b00}.wrapper{margin:0 auto;width:1200px}*{padding:0}*,p{margin:0}body{background:#f0f0f0}.wrap{width:900px;margin:0 auto}",""])},352:function(e,a,n){"use strict";n(353);var t=n(17),m=t.createClass({displayName:"SignedUpHeader",render:function(){return t.createElement("div",{className:"header"},t.createElement("div",{className:"logo-box"},t.createElement("a",{href:"/"},t.createElement("div",{className:"logo"})),t.createElement("div",{className:"title"},"找回密码")),t.createElement("p",{className:"notice"},"马上",t.createElement("a",{href:"/login"},"登录>")))}});e.exports=m},353:function(e,a,n){var t=n(354);"string"==typeof t&&(t=[[e.id,t,""]]);n(6)(t,{singleton:!1});t.locals&&(e.exports=t.locals)},354:function(e,a,n){a=e.exports=n(4)(),a.push([e.id,".header{width:100%;height:120px}.header .logo-box{float:left;padding-top:50px;position:relative}.header .logo-box .logo{height:60px;width:150px;background:url("+n(189)+") center no-repeat;background-size:auto 100%}.header .logo-box .title{position:absolute;right:-95px;top:62px;color:#333;font-size:20px}.header .notice{float:right;font-size:14px;color:#999;margin-top:90px;margin-right:5px}",""])},355:function(e,a,n){"use strict";n(356);var t=n(17),m=n(8),i=m.getRegs(),r=m.queryStringToJson,o=m.setCookie,l=m.getCookie,s=m.encryptMd5,c=n(181),p=t.createClass({displayName:"SignedUpBox",getInitialState:function(){return{step:1,user:null}},toNext:function(e){return window.history.pushState({},0,"?step="+(parseInt(this.state.step)+1)),2==this.state.step?void this.setState({user:e},function(){this.setState({step:parseInt(this.state.step)+1})}.bind(this)):void this.setState({step:parseInt(this.state.step)+1})},componentWillMount:function(){var e=r(window.location.search.substring(1,window.location.search.length)).step;e&&this.setState({step:e})},render:function(){return t.createElement("div",{className:"su-box"},t.createElement(d,{step:this.state.step}),t.createElement(h,{user:this.state.user,step:this.state.step,toNext:this.toNext}))}}),d=t.createClass({displayName:"SuStep",render:function(){return t.createElement("ul",{className:"su-step"},t.createElement("li",{className:1==this.props.step?"active":null},t.createElement("span",{className:"step-num"},"1"),t.createElement("span",null,"填写手机号")),t.createElement("li",{className:2==this.props.step?"active":null},t.createElement("span",{className:"step-num"},"2"),t.createElement("span",null,"重置密码")),t.createElement("li",{className:3==this.props.step?"active":null},t.createElement("span",{className:"step-num"},"3"),t.createElement("span",null,"重置密码成功")))}}),h=t.createClass({displayName:"SuMain",render:function(){var e="";switch(this.props.step.toString()){case"1":e=t.createElement(u,{toNext:this.props.toNext});break;case"2":e=t.createElement(x,{toNext:this.props.toNext});break;case"3":e=t.createElement(w,{user:this.props.user});break;default:e=t.createElement(u,{toNext:this.props.toNext})}return t.createElement("div",{className:"su-main"},e)}}),u=t.createClass({displayName:"SuStep1",getInitialState:function(){return{mp:"",mpErrTip:"",captcha:"",captchaErrTip:"",agree:!0,captchaTip:"获取短信验证码",isCaptchaBtnClick:!0,isNextClick:!0}},setMp:function(e){this.setState({mp:e})},checkMp:function(){var e=this.state.mp;if(0===e.length)return this.setState({mpErrTip:"请输入手机号码"}),!1;var a=i.mobile;return a.exec(e)?!0:(this.setState({mpErrTip:"请输入正确的手机号码"}),!1)},setCaptcha:function(e){this.setState({captcha:e})},checkCaptcha:function(){var e=this.state.captcha;if(0===e.length)return this.setState({captchaErrTip:"请输入验证码"}),!1;var a=i.captcha;return a.exec(e)?!0:(this.setState({captchaErrTip:"请输入正确的验证码"}),!1)},getCaptcha:function(e){this.state.mp;return this.state.mpErrTip?!1:this.state.isCaptchaBtnClick?void c({url:"/service/mobile_sms?type=USER_RESET_PASSWORD",type:"json",method:"POST",data:{mobile:this.state.mp,csrf_token:l("csrf_token")},success:function(e){e.success?(o("clickTime",Date.now()),this.setCountDown(6e4)):this.setState({mpErrTip:e.message})}.bind(this)}):!1},getCaptchaEnable:function(e){this.setState({captchaTip:e,isCaptchaBtnClick:!0})},getCaptchaDisable:function(e,a){var n=parseInt((a-e+parseInt(l("clickTime")))/1e3);this.setState({captchaTip:n+"秒后再次发送",isCaptchaBtnClick:!1})},setCountDown:function(e){this.countDown=setInterval(function(){Date.now()-l("clickTime")>=e-1e3?(clearTimeout(this.countDown),this.getCaptchaEnable("获取短信验证码"),o("clickTime","",new Date(0))):this.getCaptchaDisable(Date.now(),e)}.bind(this),200)},componentDidMount:function(){l("clickTime")&&(this.getCaptchaDisable(Date.now(),6e4),this.setCountDown(6e4))},componentWillUnmount:function(){clearTimeout(this.countDown)},setAgree:function(){this.setState({agree:!this.state.agree})},clear:function(e,a){switch(e){case"mp":if(a)return void this.setState({mpErrTip:""});this.setState({mpErrTip:"",mp:""});break;case"captcha":if(a)return void this.setState({captchaErrTip:""});this.setState({captchaErrTip:"",captcha:""});break;default:return}},doNext:function(){return 0===this.state.mp.toString().length?(this.setState({mpErrTip:"请输入手机号码"}),!1):0===this.state.captcha.toString().length?(this.setState({captchaErrTip:"请输入验证码"}),!1):this.state.agree?this.state.mpErrTip||this.state.captchaErrTip?!1:this.state.isNextClick?(this.setState({isNextClick:!1}),void c({url:"/reset_password?step=1",type:"json",method:"POST",data:{csrf_token:l("csrf_token"),mobile:this.state.mp,captcha:this.state.captcha},success:function(e){this.setState({isNextClick:!0}),e.success?this.props.toNext(null):this.setState({captchaErrTip:e.message})}.bind(this),error:function(){this.setState({isNextClick:!0})}.bind(this)})):!1:!1},render:function(){return t.createElement("form",null,t.createElement(g,{setValue:this.setMp,clear:this.clear,check:this.checkMp,value:this.state.mp,errTip:this.state.mpErrTip}),t.createElement(f,{setValue:this.setCaptcha,getCaptcha:this.getCaptcha,clear:this.clear,check:this.checkCaptcha,errTip:this.state.captchaErrTip,value:this.state.captcha,captchaTip:this.state.captchaTip,isCaptchaBtnClick:this.state.isCaptchaBtnClick}),t.createElement(b,{next:this.doNext,isNextClick:this.state.isNextClick},"下一步"))}}),g=t.createClass({displayName:"MpInputGroup",handleChange:function(e){var a=e.target.value.substring(0,11);this.props.setValue(a)},render:function(){var e=this.props.errTip;return t.createElement("div",{className:(e.length?"err ":"")+"input-group"},t.createElement("input",{value:this.props.value,onChange:this.handleChange,onFocus:this.props.clear.bind(null,"mp",1),onBlur:this.props.check,type:"text",className:"mp ipt",placeholder:"请输入你的手机号",autoFocus:!0}),t.createElement("span",{onClick:this.props.clear.bind(null,"mp",0),className:"del-icon"},"+"),t.createElement("div",{className:"tip err"},e))}}),f=t.createClass({displayName:"CaptchaInputGroup",handleChange:function(e){var a=e.target.value.substring(0,6);this.props.setValue(a)},render:function(){var e=this.props.errTip;return t.createElement("div",{className:(e.length?"err ":"")+"input-group"},t.createElement("input",{value:this.props.value,onChange:this.handleChange,onFocus:this.props.clear.bind(null,"captcha",1),onBlur:this.props.check,type:"text",className:"captcha ipt",placeholder:"请输入短信验证码"}),t.createElement("input",{onClick:this.props.getCaptcha,type:"button",className:(this.props.isCaptchaBtnClick?"able ":"")+"send-captcha",value:this.props.captchaTip,disabled:!this.props.isCaptchaBtnClick}),t.createElement("span",{onClick:this.props.clear.bind(null,"captcha",0),className:"del-icon captcha"},"+"),t.createElement("div",{className:"tip err"},e))}}),b=(t.createClass({displayName:"AgreeInputGroup",render:function(){return t.createElement("div",{className:(this.props.agree?"":"err ")+"input-group agree"},t.createElement("input",{type:"checkbox",className:"agree",name:"agree",id:"agree"}),t.createElement("label",{onClick:this.props.setValue,className:(this.props.agree?"checked ":"")+"check",htmlFor:"agree"}),t.createElement("label",{className:"instruct",htmlFor:"agree"},"注册表示你同意万木家",t.createElement("a",{href:"#"},"《用户使用条款》")),t.createElement("div",{className:"tip err"},"你必须同意万木家服务条款后，才能提交注册"))}}),t.createClass({displayName:"NextButton",render:function(){return t.createElement("div",{className:"input-group"},t.createElement("input",{disabled:!this.props.isNextClick,onClick:this.props.next,type:"button",value:this.props.children,className:"next"}),t.createElement("div",{className:"tip err"}))}})),x=t.createClass({displayName:"SuStep2",getInitialState:function(){return{psw:"",pswErrTip:"",pswagain:"",pswagainErrTip:"",isNextClick:!0}},setPsw:function(e){this.setState({psw:e})},checkPsw:function(){var e=this.state.psw;if(0===e.length)return this.setState({pswErrTip:"请输入密码"}),!1;var a=i.userPassword;return a.exec(e)?!0:(this.setState({pswErrTip:"请输入正确格式的密码"}),!1)},setPswagain:function(e){this.setState({pswagain:e});var a=e;return 0===a.length?!1:a.length>this.state.psw.length||a!=this.state.psw.substr(0,a.length)?(this.setState({pswagainErrTip:"两次输入密码不一致"}),!1):(this.setState({pswagainErrTip:""}),!0)},checkPswagain:function(){return this.state.pswagain!==this.state.psw?(this.setState({pswagainErrTip:"两次输入密码不一致"}),!1):void 0},clear:function(e,a){switch(e){case"psw":if(a)return void this.setState({pswErrTip:""});this.setState({pswErrTip:"",psw:""});break;case"pswagain":if(a)return void this.setState({pswagainErrTip:""});this.setState({pswagainErrTip:"",pswagain:""});break;default:return}},doNext:function(){if(0===this.state.psw.toString().length)return this.setState({mpErrTip:"请输入密码"}),!1;if(0===this.state.pswagain.toString().length)return this.setState({pswagainErrTip:"请再次输入密码"}),!1;if(this.state.pswErrTip||this.state.pswagainErrTip)return!1;if(this.state.psw==this.state.pswagain){if(!this.state.isNextClick)return!1;this.setState({isNextClick:!1}),c({url:"reset_password?step=2",method:"POST",type:"json",data:{password:s(this.state.psw),confirm_password:s(this.state.pswagain),csrf_token:l("csrf_token")},success:function(e){this.setState({isNextClick:!0}),e.success?this.props.toNext(e.user):this.setState({pswErrTip:e.message})}.bind(this),error:function(){this.setState({isNextClick:!0})}.bind(this)})}},render:function(){return t.createElement("form",null,t.createElement(v,{setValue:this.setPsw,clear:this.clear,check:this.checkPsw,value:this.state.psw,errTip:this.state.pswErrTip}),t.createElement(k,{setValue:this.setPswagain,clear:this.clear,check:this.checkPswagain,value:this.state.pswagain,errTip:this.state.pswagainErrTip}),t.createElement(b,{next:this.doNext,isNextClick:this.state.isNextClick},"完成"))}}),v=t.createClass({displayName:"PswInputGroup",handleChange:function(e){var a=e.target.value;this.props.setValue(a)},render:function(){var e=this.props.errTip;return t.createElement("div",{className:(e.length?"err ":"")+"input-group"},t.createElement("input",{value:this.props.value,onChange:this.handleChange,onFocus:this.props.clear.bind(null,"psw",1),onBlur:this.props.check,type:"password",className:"ipt",autoFocus:!0,placeholder:"请设置账号密码"}),t.createElement("div",{className:"ipt-tip"},"密码为6-16位字符，支持字母、数字与“.”及“_”的组合"),t.createElement("span",{onClick:this.props.clear.bind(null,"psw",0),className:"del-icon"},"+"),t.createElement("div",{className:"tip err"},e))}}),k=t.createClass({displayName:"PswCheckInputGroup",handleChange:function(e){var a=e.target.value;this.props.setValue(a)},render:function(){var e=this.props.errTip;return t.createElement("div",{className:(e.length?"err ":"")+"input-group"},t.createElement("input",{value:this.props.value,onChange:this.handleChange,onFocus:this.props.clear.bind(null,"pswagain",1),onBlur:this.props.check,type:"password",className:"ipt",placeholder:"请再次输入密码"}),t.createElement("span",{onClick:this.props.clear.bind(null,"pswagain",0),className:"del-icon"},"+"),t.createElement("div",{className:"tip err"},e))}}),w=t.createClass({displayName:"SuStep3",getInitialState:function(){return{second:3}},componentDidMount:function(){setInterval(function(){this.setState({second:--this.state.second},function(){0===this.state.second&&(window.location.href="/login")})}.bind(this),1e3)},render:function(){return t.createElement("div",{className:"result-box"},t.createElement("div",{className:"result-title"},"找回密码成功"),t.createElement("p",{className:"result-detail"}),t.createElement("p",{className:"result-detail"}),t.createElement("div",{className:"return"},t.createElement("div",{className:"r"},"系统将在",this.state.second,"秒后自动跳转到登录页面"),t.createElement("a",{href:"/"},"立即跳转")))}});e.exports=p},356:function(e,a,n){var t=n(357);"string"==typeof t&&(t=[[e.id,t,""]]);n(6)(t,{singleton:!1});t.locals&&(e.exports=t.locals)},357:function(e,a,n){a=e.exports=n(4)(),a.push([e.id,".su-box{border:1px solid #e6e6e6;background:#fff;box-shadow:0 0 3px #ccc}.su-box .su-step{border-bottom:1px solid #e6e6e6;height:100px;padding:40px 138px 0 180px}.su-box .su-step li{position:relative;float:left;list-style:none;width:27%;margin-right:6%;text-align:left;line-height:60px;font-size:18px;color:#999;padding-left:6%}.su-box .su-step li .step-num{position:absolute;color:#fff;background:#999;text-align:center;display:block;line-height:18px;width:18px;height:18px;border-radius:18px;font-size:16px;left:8px;bottom:21px}.su-box .su-step li.active{border-bottom:2px solid #6e3800;color:#6e3800;font-weight:bolder}.su-box .su-step li.active .step-num{background:#6e3800;font-weight:400}.su-box .su-main{width:100%;height:auto;padding:50px 0}.su-box .su-main .input-group{margin-left:270px;position:relative;padding-bottom:30px}.su-box .su-main .input-group input{font-size:15px;outline:none}.su-box .su-main .input-group .ipt{width:350px;height:38px;padding-left:8px;border:1px solid #ccc}.su-box .su-main .input-group .ipt.captcha{width:222px}.su-box .su-main .input-group .del-icon.captcha{left:202px}.su-box .su-main .input-group .del-icon{display:none;position:absolute;font-size:16px;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);text-align:center;background:#6e3800;color:#fff;width:13px;height:13px;line-height:13px;border-radius:13px;top:14px;left:330px;cursor:pointer}.su-box .su-main .input-group .tip{position:absolute;display:none;font-size:13px}.su-box .su-main .input-group.err .ipt{border-color:#6e3800}.su-box .su-main .input-group.err .del-icon{display:block}.su-box .su-main .input-group.err .tip{display:block;color:#6e3800;line-height:30px;padding-left:8px}.su-box .su-main .send-captcha{width:118px;border:1px solid #ccc;height:38px;margin-left:8px;background:#f5f5f5;color:#666;font-size:13px;text-align:center;cursor:pointer}.su-box .su-main .send-captcha.able:hover{color:#4b4343;border:1px solid #4b4343}.su-box .su-main .input-group.agree{margin-top:14px}.su-box .su-main .input-group.agree #agree{display:none}.su-box .su-main .input-group.agree .check{float:left;width:14px;height:14px;border:2px solid #6e3800;cursor:pointer;position:relative;top:6px;margin:0 10px 0 0}.su-box .su-main .input-group.agree .check.checked:after{display:block;content:'\\F00C';font-weight:400;font-size:12px;line-height:12px;text-align:center;background:#6e3800;color:#fff}.su-box .su-main .input-group.agree .instruct{font-size:14px;color:#999}.su-box .su-main .input-group.agree .instruct a{text-decoration:none;color:#561b1b}.su-box .su-main .next{width:362px;height:40px;margin-top:10px;border:none;text-align:center;font-size:16px;color:#fff;background:#6e3800;cursor:pointer}.su-box .su-main .ipt-tip{font-size:13px;color:#999;margin-top:8px}.su-box .su-main .result-box{text-align:center}.su-box .su-main .result-box .result-title{color:#6e3800;font-size:40px;line-height:100px}.su-box .su-main .result-box .result-detail{line-height:30px;font-size:14px;color:#999}.su-box .su-main .result-box .result-detail .d{color:#000;font-size:15px;margin-right:15px}.su-box .su-main .result-box .return{margin-top:60px}.su-box .su-main .result-box .return .r{font-size:14px;color:#6e3800}.su-box .su-main .result-box .return a{text-decoration:none;height:40px;width:160px;background:#6e3800;color:#fff;display:block;margin:0 auto;line-height:40px;text-align:center;margin-top:20px}",""])}});